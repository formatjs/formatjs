{"version":3,"file":"intl-relativeformat.js","sources":["../lib/diff.js","../lib/index.js"],"sourcesContent":["/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\nfunction daysToYears(days) {\n    // 400 years have 146097 days (taking into account leap year rules)\n    return (days * 400) / 146097;\n}\n// Thanks to date-fns\n// https://github.com/date-fns/date-fns\n// MIT Â© Sasha Koss\nvar MILLISECONDS_IN_MINUTE = 60000;\nvar MILLISECONDS_IN_DAY = 86400000;\nfunction startOfDay(dirtyDate) {\n    var date = new Date(dirtyDate);\n    date.setHours(0, 0, 0, 0);\n    return date;\n}\nfunction differenceInCalendarDays(dirtyDateLeft, dirtyDateRight) {\n    var startOfDayLeft = startOfDay(dirtyDateLeft);\n    var startOfDayRight = startOfDay(dirtyDateRight);\n    var timestampLeft = startOfDayLeft.getTime() -\n        startOfDayLeft.getTimezoneOffset() * MILLISECONDS_IN_MINUTE;\n    var timestampRight = startOfDayRight.getTime() -\n        startOfDayRight.getTimezoneOffset() * MILLISECONDS_IN_MINUTE;\n    // Round the number of days to the nearest integer\n    // because the number of milliseconds in a day is not constant\n    // (e.g. it's different in the day of the daylight saving time clock shift)\n    return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_DAY);\n}\nexport default function diff(from, to) {\n    // Convert to ms timestamps.\n    from = +from;\n    to = +to;\n    var millisecond = Math.round(to - from), second = Math.round(millisecond / 1000), minute = Math.round(second / 60), hour = Math.round(minute / 60);\n    // We expect a more precision in rounding when dealing with\n    // days as it feels wrong when something happended 13 hours ago and\n    // is regarded as \"yesterday\" even if the time was this morning.\n    var day = differenceInCalendarDays(to, from);\n    var week = Math.round(day / 7);\n    var rawYears = daysToYears(day), month = Math.round(rawYears * 12), year = Math.round(rawYears);\n    return {\n        second: second,\n        'second-short': second,\n        'second-narrow': second,\n        minute: minute,\n        'minute-short': minute,\n        'minute-narrow': minute,\n        hour: hour,\n        'hour-short': hour,\n        'hour-narrow': hour,\n        day: day,\n        'day-short': day,\n        'day-narrow': day,\n        week: week,\n        'week-short': week,\n        'week-narrow': week,\n        month: month,\n        'month-short': month,\n        'month-narrow': month,\n        year: year,\n        'year-short': year,\n        'year-narrow': year\n    };\n}\n//# sourceMappingURL=diff.js.map","/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\nimport diff from './diff';\n// -----------------------------------------------------------------------------\nvar SUPPORTED_FIELDS = [\n    \"second\" /* second */,\n    \"second-short\" /* secondShort */,\n    \"minute\" /* minute */,\n    \"minute-short\" /* minuteShort */,\n    \"hour\" /* hour */,\n    \"hour-short\" /* hourShort */,\n    \"day\" /* day */,\n    \"day-short\" /* dayShort */,\n    \"month\" /* month */,\n    \"month-short\" /* monthShort */,\n    \"year\" /* year */,\n    \"year-short\" /* yearShort */\n];\nfunction isValidUnits(units) {\n    if (!units || ~SUPPORTED_FIELDS.indexOf(units)) {\n        return true;\n    }\n    if (typeof units === 'string') {\n        var suggestion = /s$/.test(units) && units.substr(0, units.length - 1);\n        if (suggestion &&\n            ~SUPPORTED_FIELDS.indexOf(suggestion)) {\n            throw new Error(\"\\\"\" + units + \"\\\" is not a valid IntlRelativeFormat 'units' value, did you mean: \" + suggestion);\n        }\n    }\n    throw new Error(\"\\\"\" + units + \"\\\" is not a valid IntlRelativeFormat 'units' value, it must be one of: \" + SUPPORTED_FIELDS.join('\", \"'));\n}\nfunction resolveStyle(style) {\n    // Default to \"best fit\" style.\n    if (!style) {\n        return \"best fit\" /* bestFit */;\n    }\n    if (style === 'best fit' || style === 'numeric') {\n        return style;\n    }\n    throw new Error(\"\\\"\" + style + \"\\\" is not a valid IntlRelativeFormat 'style' value, it must be one of: 'best fit' or 'numeric'\");\n}\nfunction selectUnits(diffReport) {\n    var fields = SUPPORTED_FIELDS.filter(function (field) {\n        return field.indexOf('-short') < 1;\n    });\n    var units = fields[0];\n    for (var _i = 0, fields_1 = fields; _i < fields_1.length; _i++) {\n        units = fields_1[_i];\n        if (Math.abs(diffReport[units]) < RelativeFormat.thresholds[units]) {\n            break;\n        }\n    }\n    return units;\n}\nvar RelativeFormat = (function (locales, options) {\n    if (options === void 0) { options = {}; }\n    var resolvedOptions = {\n        style: resolveStyle(options.style),\n        units: isValidUnits(options.units) && options.units\n    };\n    var numeric = resolvedOptions.style === 'best fit' ? 'auto' : 'always';\n    var rtf = new Intl.RelativeTimeFormat(locales, {\n        numeric: numeric\n    });\n    return {\n        format: function (date, options) {\n            var now = options && options.now !== undefined\n                ? options.now === null\n                    ? 0\n                    : options.now\n                : Date.now();\n            if (date === undefined) {\n                date = now;\n            }\n            // Determine if the `date` and optional `now` values are valid, and throw a\n            // similar error to what `Intl.DateTimeFormat#format()` would throw.\n            if (!isFinite(now)) {\n                throw new RangeError('The `now` option provided to IntlRelativeFormat#format() is not ' +\n                    'in valid range.');\n            }\n            if (!isFinite(date)) {\n                throw new RangeError('The date value provided to IntlRelativeFormat#format() is not ' +\n                    'in valid range.');\n            }\n            var diffReport = diff(now, date);\n            var units = resolvedOptions.units || selectUnits(diffReport);\n            var diffInUnits = diffReport[units];\n            var style = units.substring(units.length - 6, units.length) === '-short'\n                ? 'narrow'\n                : 'long';\n            var rtfUnit = units.replace('-short', '');\n            return new Intl.RelativeTimeFormat(locales, {\n                numeric: numeric,\n                style: style\n            }).format(diffInUnits, rtfUnit);\n        },\n        resolvedOptions: function () {\n            return {\n                locale: rtf.resolvedOptions().locale,\n                style: resolvedOptions.style,\n                units: resolvedOptions.units\n            };\n        }\n    };\n});\n// Define public `defaultLocale` property which can be set by the developer, or\n// it will be set when the first RelativeFormat instance is created by\n// leveraging the resolved locale from `Intl`.\nRelativeFormat.defaultLocale = 'en';\nRelativeFormat.thresholds = {\n    second: 45,\n    'second-short': 45,\n    minute: 45,\n    'minute-short': 45,\n    hour: 22,\n    'hour-short': 22,\n    day: 26,\n    'day-short': 26,\n    month: 11,\n    'month-short': 11 // months to year\n};\nexport default RelativeFormat;\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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"}